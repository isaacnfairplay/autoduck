# Task: Let's create a small, focused example demonstrating DuckDB's window functions in the relational API. We'll calculate cumulative sales and rank products within categories using a concise, targeted approach.

## Step 1: Let's create a small, focused example demonstrating DuckDB's window functions in the relational API. We'll calculate cumulative sales and rank products within categories using a concise, targeted approach.

**Generated by**: Anthropic

```python
import duckdb

conn = duckdb.connect(':memory:')

# Create sample sales data
conn.sql("""
CREATE TABLE sales AS
SELECT 'Electronics' as category, 'Laptop' as product, 1200 as price
UNION ALL
SELECT 'Electronics', 'Smartphone', 800
UNION ALL
SELECT 'Clothing', 'Shirt', 50
UNION ALL
SELECT 'Clothing', 'Jeans', 100
""")

# Calculate cumulative sales and product rank within category
result = conn.sql("""
SELECT 
    category, 
    product, 
    price,
    SUM(price) OVER (PARTITION BY category ORDER BY price) as cumulative_category_sales,
    RANK() OVER (PARTITION BY category ORDER BY price DESC) as product_rank
FROM sales
""").fetchall()

for row in result:
    print(row)
```

**Result**: [('Electronics', 'Laptop', 1200, 2000, 1), ('Electronics', 'Smartphone', 800, 800, 2), ('Clothing', 'Jeans', 100, 150, 1), ('Clothing', 'Shirt', 50, 50, 2)]

**Explanation**: Demonstrates DuckDB window functions by calculating cumulative sales per category and ranking products within categories using PARTITION BY and window function techniques.
