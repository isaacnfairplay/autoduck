# Task: I'll focus on creating a concise, targeted example demonstrating DuckDB's window functions using the relational API. The example will show cumulative sales ranking within product categories.

## Step 1: I'll focus on creating a concise, targeted example demonstrating DuckDB's window functions using the relational API. The example will show cumulative sales ranking within product categories.

**Generated by**: Anthropic

```python
import duckdb

con = duckdb.connect(':memory:')

# Create sales data
con.sql("""
CREATE TABLE sales AS
SELECT 'Electronics' as category, 1500 as amount
UNION ALL
SELECT 'Electronics', 2300
UNION ALL
SELECT 'Clothing', 1200
UNION ALL
SELECT 'Clothing', 1800
""")

# Compute cumulative sales with window function
result = con.sql("""
SELECT 
    category, 
    amount,
    SUM(amount) OVER (PARTITION BY category ORDER BY amount) as cumulative_category_sales
FROM sales
""").fetchall()

print(result)
```

**Result**: [('Electronics', 1500, 1500), ('Electronics', 2300, 3800), ('Clothing', 1200, 1200), ('Clothing', 1800, 3000)]

**Explanation**: Demonstrates a window function (SUM with OVER clause) to compute cumulative sales within each product category, partitioning and ordering the calculation
