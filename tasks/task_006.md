# Task: Sure! Let's create a focused example that demonstrates DuckDB's window function capabilities in the relational API. We'll explore calculating cumulative sales and ranking within product categories using a small dataset.

## Step 1: Sure! Let's create a focused example that demonstrates DuckDB's window function capabilities in the relational API. We'll explore calculating cumulative sales and ranking within product categories using a small dataset.

**Generated by**: Anthropic

```python
import duckdb

# Create an in-memory database
conn = duckdb.connect(':memory:')

# Create sales table with product and sales data
conn.execute('''
    CREATE TABLE sales (
        product_category VARCHAR,
        sale_amount DECIMAL(10,2)
    );
''')

# Insert sample sales data
conn.executemany('INSERT INTO sales VALUES (?, ?)', [
    ('Electronics', 500.00),
    ('Electronics', 750.50),
    ('Clothing', 250.25),
    ('Clothing', 300.75),
    ('Electronics', 1200.00)
])

# Calculate cumulative sales and rank within product categories
result = conn.execute('''
    SELECT 
        product_category, 
        sale_amount,
        SUM(sale_amount) OVER (PARTITION BY product_category ORDER BY sale_amount) as cumulative_sales,
        RANK() OVER (PARTITION BY product_category ORDER BY sale_amount DESC) as sales_rank
    FROM sales
''').fetchall()

for row in result:
    print(row)
```

**Result**: [('Electronics', Decimal('1200.00'), Decimal('2450.50'), 1), ('Electronics', Decimal('750.50'), Decimal('1250.50'), 2), ('Electronics', Decimal('500.00'), Decimal('500.00'), 3), ('Clothing', Decimal('300.75'), Decimal('551.00'), 1), ('Clothing', Decimal('250.25'), Decimal('250.25'), 2)]

**Explanation**: Demonstrates DuckDB window functions by calculating cumulative sales and ranking sales within product categories, showcasing partitioning, ordering, and aggregation capabilities.
